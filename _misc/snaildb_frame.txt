DROP DATABASE IF EXISTS snaildb;
CREATE DATABASE snaildb;
USE snaildb;

CREATE TABLE IF NOT EXISTS Customer(
	id INT NOT NULL AUTO_INCREMENT,
	first_name VARCHAR(25) NOT NULL,
	last_name VARCHAR(25) NOT NULL,
	dob DATE NOT NULL,
	address VARCHAR(50) NOT NULL,
	zip_code VARCHAR(5) NOT NULL,
	phone VARCHAR(13) NOT NULL,
	email VARCHAR(25) NOT NULL,
	PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS CustomerOrder(
	id INT NOT NULL AUTO_INCREMENT,
	cargo_id INT NOT NULL,
	order_date DATE NOT NULL,
	shipped_date DATE,
	arrived_date DATE,
	received_date DATE,
	customer_id INT NOT NULL,
	status VARCHAR(10),
	PRIMARY KEY (id)
);
	
CREATE TABLE IF NOT EXISTS Station(
	name VARCHAR(15) NOT NULL,
	address VARCHAR(50) NOT NULL,
	zip_code VARCHAR(5) NOT NULL,
	PRIMARY KEY (name)
);
	
CREATE TABLE IF NOT EXISTS ZipCode(
	zip_code VARCHAR(5) NOT NULL,
	city VARCHAR(25) NOT NULL,
	state VARCHAR(25) NOT NULL,
	PRIMARY KEY (zip_code)
);

CREATE TABLE IF NOT EXISTS Rate(
	route VARCHAR(6) NOT NULL,
	station_from VARCHAR(15) NOT NULL,
	station_to VARCHAR(15) NOT NULL,
	fee_per_lb DECIMAL(5,2) NOT NULL,
	PRIMARY KEY (route)
);

CREATE TABLE IF NOT EXISTS ShoppingCart(
	customer_id INT NOT NULL,
	cargo_id INT NOT NULL,
	PRIMARY KEY (customer_id)
);

CREATE TABLE IF NOT EXISTS CargoType(
	type VARCHAR(10) NOT NULL,
	rate DECIMAL(3,1) NOT NULL,
	PRIMARY KEY (type)
);

CREATE TABLE IF NOT EXISTS ShippingType(
	type VARCHAR(10) NOT NULL,
	rate DECIMAL(3,1) NOT NULL,
	PRIMARY KEY (type)
);

CREATE TABLE IF NOT EXISTS Cargo(
	id INT NOT NULL AUTO_INCREMENT,
	route VARCHAR(6) NOT NULL,
	weight DECIMAL(10,1) NOT NULL,
	cargo_type VARCHAR(10) NOT NULL,
	shipping_type VARCHAR(10) NOT NULL,
	price DECIMAL(10,2) NOT NULL,
	PRIMARY KEY (id)
);

ALTER TABLE Customer
ADD FOREIGN KEY (zip_code)
REFERENCES ZipCode(zip_code);

ALTER TABLE CustomerOrder
ADD FOREIGN KEY (cargo_id)
REFERENCES Cargo(id);

ALTER TABLE CustomerOrder
ADD FOREIGN KEY (customer_id)
REFERENCES Customer(id);

ALTER TABLE Station
ADD FOREIGN KEY (zip_code)
REFERENCES ZipCode(zip_code);

ALTER TABLE Cargo
ADD FOREIGN KEY (route)
REFERENCES Rate(route);

ALTER TABLE Cargo
ADD FOREIGN KEY (cargo_type)
REFERENCES CargoType(type);

ALTER TABLE Cargo
ADD FOREIGN KEY (shipping_type)
REFERENCES ShippingType(type);

ALTER TABLE Rate
ADD FOREIGN KEY (station_from)
REFERENCES Station(NAME);

ALTER TABLE Rate
ADD FOREIGN KEY (station_to)
REFERENCES Station(NAME);

ALTER TABLE ShoppingCart
ADD FOREIGN KEY (customer_id)
REFERENCES Customer(id);

ALTER TABLE ShoppingCart
ADD FOREIGN KEY (cargo_id)
REFERENCES Cargo(id);